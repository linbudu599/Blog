---
category: Learning
date: 2021-3-20
title: 来瞅瞅这些推进中的TC39提案
---

## 前言

最近看到了一些很有趣的ES提案，如顶级await、Record与Tuple数据类型等，可以认为一旦这些提案完全进入到ES新特性中，前端er们的工作效率又会upup，因此这篇文章就来介绍一下我认为值得关注的ES提案。

作为前端同学，即使你没有去主动了解过，应该也或多或少听说过ECMA、ECMAScript、TC39、ES6（这个当然了）这些词，你可能对这些名词代表的概念一知半解甚至是从未了解过，但这很正常，不知道这些名词的关系并不影响你将ES新特性用的如臂使指。但了解一下也不亏？所以在开始正式介绍各种提案前，我们有必要先了解一下这些概念。

> 以下关于背景的介绍大部分来自于雪碧老师的[JavaScript20年-创立标准](https://cn.history.js.org/part-2.html)一节。

- [ECMA（European Computer Manufacturers Association，欧洲计算机制造商协会）](https://www.ecma-international.org/)，这是一个国际组织，主要负责维护各种计算机的相关标准。我们都知道JavaScript这门语言最早来自于网景（Netscape），但网景在和微软（IE）的竞争落得下风，为了避免最终Web脚本主导权落入微软手中，网景开始寻求ECMA组织的帮助，来推动JavaScript的标准化。
- 在1996年，JavaScript正式加入了ECMA大家庭，我们后面会叫它ECMAScript（下文简称ES）。TC39则是ECMA为ES专门组织的技术委员会（Technical Committee），39这个数字则是因为ECMA使用数字来标记旗下的技术委员会。TC39的成员由各个主流浏览器厂商的代表构成（因为毕竟最后还要这些人实现嘛）。
- ECMA-262即为ECMA组织维护的第262条标准，这一标准是在不断演进的，如现在是[2020年6月发布的第11版](https://www.ecma-international.org/publications-and-standards/standards/ecma-262/)。同样的，目前最为熟知的是[2015年发布的ES6](https://262.ecma-international.org/6.0/index.html)。你还可以在[TC39的ECMA262官网](https://tc39.es/ecma262/)上看到ES2022的最新草案。
- ECMA还维护着许多其他方面的标准，如[ECMA-414](https://www.ecma-international.org/publications-and-standards/standards/ecma-414/)，定义了一组ES规范套件的标准；[ECMA-404](https://www.ecma-international.org/publications-and-standards/standards/ecma-404/)，定义了JSON数据交换的语法；甚至还有120mm DVD的标准：[ECMA267](https://www.ecma-international.org/publications-and-standards/standards/ecma-267/)。
- 对于一个提案从提出到最后被纳入ES新特性，TC39的规范中有五步要走：
  - stage0（**strawman**），任何TC39的成员都可以提交。
  - stage1（**proposal**），进入此阶段就意味着这一提案被认为是**正式**的了，需要对此提案的场景与API进行详尽的描述。
  - stage2（**draft**），演进到这一阶段的提案如果能最终进入到标准，那么在之后的阶段都不会有太大的变化，因为理论上只接受增量修改。
  - state3（**candidate**），这一阶段的提案只有在遇到了重大问题才会修改，规范文档需要被全面的完成。
  - state4（**finished**），这一阶段的提案将会被纳入到ES每年发布的规范之中。
- 有兴趣的同学可以阅读 [The TC39 process for ECMAScript features](https://2ality.com/2015/11/tc39-process.html) 了解更多。

## Record & Tuple（stage2）

[proposal-record-tuple](https://github.com/tc39/proposal-record-tuple) 这一提案为JavaScript新增了两种数据结构：Record（类似于对象） 和 Tuple（类似于数组），它们的共同点是都是不可变的（Immutable），同时成员只能是原始类型以及同样不可变的Record和Tuple。正因为它们的成员不能包含引用类型，所以它们是 **按值比较** 的，成员完全一致的Record和Tuple如果进行比较，会被认为是相同的（'==='会返回true）。

> 你可能会想到社区其实对于数据不可变已经有不少方案了，如ImmutableJS与Immer。而数据不可变同样是React中的重要概念。

使用示例：

```js
// Record
const proposal = #{
  id: 1234,
  title: "Record & Tuple proposal",
  contents: `...`,
  keywords: #["ecma", "tc39", "proposal", "record", "tuple"],
};


// Tuple
const measures = #[42, 12, 67, "measure error: foo happened"];
```



## Private Methods (stage 3)

[private-methods](https://github.com/tc39/proposal-private-methods)



## Top-level `await` (stage3)

[proposal-top-level-await](https://github.com/tc39/proposal-top-level-await)



## Import Assertions (stage 3)

[proposal-import-assertions](https://github.com/tc39/proposal-import-assertions)



## Error Cause (stage 3)

[proposal-error-cause](https://github.com/tc39/proposal-error-cause)

吞吞老师主导



## Decorators (stage 2)

[proposal-decorators](https://github.com/tc39/proposal-decorators)

ES 装饰器、TS装饰器、AS、Angular团队



## `throw` Expressions (stage 2)

[proposal-throw-expressions](https://github.com/tc39/proposal-throw-expressions)



## Set Methods (stage 2)

[proposal-set-methods](https://github.com/tc39/proposal-set-methods)



## Upsert(Map.prototype.emplace) (stage 2)

[proposal-upsert](https://github.com/tc39/proposal-upsert)



## Observable (stage 1)

[proposal-observable](https://github.com/tc39/proposal-observable)



## Promise.try (stage 1)

[proposal-promise-try](https://github.com/tc39/proposal-promise-try)



## Do Expression (stage 1)

[proposal-do-expressions](https://github.com/tc39/proposal-do-expressions)



## Pipeline Operator (stage 1)

[proposal-pipeline-operator](https://github.com/tc39/proposal-pipeline-operator)



## Operator Overloading (stage 1)

[proposal-operator-overloading](https://github.com/tc39/proposal-operator-overloading)



## await.all (stage 1)

[proposal-await.ops](https://github.com/tc39/proposal-await.ops)



## Array Unique (stage 1)

[proposal-array-unique](https://github.com/tc39/proposal-array-unique)



## Async Do Expression

[proposal-async-do-expressions](https://github.com/tc39/proposal-async-do-expressions)